# Larabase - шаблон для микросевисов на PHP фреймворке Laravel

## Требуется
- PHP >= 7.2

## Описание
Шаблон для создания микросервисов на основе фреймворка [Laravel](https://laravel.com/).
Оставлен код необходимый для написания приложений обрабатывающих запросы по HTTP в формате REST API.
Т.е нет состояний - сессий, нет вьюшек.

## Запуск сервиса
Создать .env файл на основе .env.example (TODO уточнить, возможно не нужно). Собираем докер образ из исходников

``` docker build -t larabase -f docker/Dockerfile . ```

Запустить, прокинув в контейнер папку с исходниками:
 
``` docker run -v $(pwd):/srv/www/app larabase ```

Не забудь скачать пакеты:

``` docker run -v $(pwd):/srv/www/app larabase composer install ```

## Документация
* Документация генерируется на основе Open APIv3. 
* Swagger файл лежит по умолчанию в папке storage/api-docs/api-docs.json.
* Документация в json доступно по адресу /api/doc
* Документация в UI доступно по адресу /api/swaggerui, см конфиг l5-swagger.php
* После добавление нового маршрута в api.php, нужно запустить команду
```php
php artisan l5-swagger:generate
```

## Создание сервиса на основе Larabase
Делаем Fork проекта. После того как сделали форк, отвязываем новый проект от Larabase. Иначе изменения в новом проекте 
будут попадать в Larabase.

Смотрим ENVIRONMENT.md, прописываем нужные переменные окружения. Например APP_NAME, у каждого сервиса должен быть
 уникальным.

#### Настройик для kubernetes
В папке .helm находятся настройки для kubernetes.
values.yaml - файл с общими настройкаи и для staiging и для боя.

prerelease.yaml - файл с настройками для staiging. Перезыписывает одинаковые настройки с values.yaml.

master.yaml - файл с настройками для боя. Перезыписывает одинаковые настройки с values.yaml.
